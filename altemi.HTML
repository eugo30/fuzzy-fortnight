<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TERMINAL 1 ALTHEMI</title>

<style>
body { background:#0b0b0b; color:#eee; font-family:'Segoe UI',sans-serif; display:flex; margin:0; }

.sidebar { width:220px; background:#151515; height:100vh; padding:20px; border-right:1px solid #333; }

.main { flex:1; display:flex; justify-content:center; padding:30px; }

.card { background:#1a1a1a; width:450px; padding:25px; border-radius:20px; border:1px solid #fbcc5c; box-shadow:0 0 30px rgba(251,204,92,0.1); }

h2 { text-align:center; color:#fbcc5c; margin-bottom:10px; }

.price-box { text-align:center; margin-bottom:15px; }

.live-price { font-size:2em; font-weight:bold; color:#2ecc71; }

.rate { font-size:0.8em; color:#888; }

.signal { padding:10px; border-radius:8px; margin-top:8px; font-weight:bold; text-align:center; }

.buy { background:rgba(46,204,113,0.15); color:#2ecc71; border:1px solid #2ecc71; }
.sell { background:rgba(231,76,60,0.15); color:#e74c3c; border:1px solid #e74c3c; }
.wait { background:rgba(241,196,15,0.15); color:#f1c40f; border:1px solid #f1c40f; }

.input-box { background:#222; padding:12px; border-radius:10px; margin-bottom:15px; }

label { font-size:0.75em; color:#aaa; text-transform:uppercase; }

input { width:100%; padding:8px; margin-bottom:8px; background:#000; border:1px solid #333; color:#fbcc5c; border-radius:5px; }

.result { background:#222; padding:15px; border-radius:10px; text-align:center; }

.profit { color:#2ecc71; font-size:1.6em; font-weight:bold; }
.loss { color:#e74c3c; font-size:1.6em; font-weight:bold; }

.stats { font-size:0.8em; color:#888; margin-top:8px; }

.log-window { height:150px; overflow-y:auto; background:#000; border-radius:8px; padding:8px; margin-top:10px; font-family:monospace; }

button { width:100%; padding:8px; margin-bottom:8px; background:#333; color:white; border:none; border-radius:5px; cursor:pointer; }

button:hover { background:#444; }

.audio-note { font-size:0.6em; color:#555; text-align:center; margin-top:5px; }
</style>
</head>

<body onclick="enableAudio()">

<div class="sidebar">
<h3>TERMINAL 1</h3>
<button onclick="toggleBot()">Toggle Terminal</button>
<button onclick="downloadCSV()">Export Logs</button>
<button onclick="clearLogs()" style="color:#e74c3c;">Reset Data</button>
</div>

<div class="main">
<div id="terminal" class="card">

<h2>CELO SEEL/O</h2>

<div class="price-box">
<div id="livePrice" class="live-price">Loading...</div>
<div class="rate">Rate: <span id="liveRate">--</span> CELO per $1</div>
<div id="signalBox" class="signal wait">SYNCING...</div>
</div>

<div class="input-box">
<label>Your Investment (USD)</label>
<input type="number" id="myUsd" value="4.66" oninput="updateCalculations()">

<label>Exchange Rate Bought At</label>
<input type="number" id="myRate" value="12.40" oninput="updateCalculations()">
</div>

<div class="result">
<div>Current Position</div>
<div id="profitAmount">$0.00</div>
<div id="profitPercent">0%</div>
<hr style="border:0;border-top:1px solid #333;margin:10px 0;">
<div>You own <span id="totalCelo">0</span> CELO worth <span id="totalVal">$0</span></div>
<div class="stats">
Z-Score: <span id="zVal">--</span> |
Mean: <span id="meanVal">--</span>
</div>
</div>

<div class="log-window" id="logWindow"></div>
<div class="audio-note" id="audioNote">Click anywhere to enable sound ðŸ””</div>

</div>
</div>

<script>
let currentPrice = 0;
let priceHistory = [];
let logs = JSON.parse(localStorage.getItem('celo_logs')) || [];
const WINDOW = 15;
let audioEnabled = false;
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function enableAudio(){
if(audioCtx.state==='suspended') audioCtx.resume();
audioEnabled=true;
document.getElementById('audioNote').innerText="Sound Active âœ…";
}

function playAlert(type){
if(!audioEnabled) return;
const osc=audioCtx.createOscillator();
const gain=audioCtx.createGain();
osc.connect(gain); gain.connect(audioCtx.destination);
osc.frequency.value=type==='buy'?880:440;
gain.gain.setValueAtTime(0.1,audioCtx.currentTime);
gain.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+0.5);
osc.start(); osc.stop(audioCtx.currentTime+0.5);
}

async function fetchPrice(){
try{
const res=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=celo&vs_currencies=usd");
const data=await res.json();
currentPrice=data.celo.usd;

document.getElementById('livePrice').innerText="$"+currentPrice.toFixed(4);
document.getElementById('liveRate').innerText=(1/currentPrice).toFixed(2);

updateZ(currentPrice);
updateCalculations();

}catch(e){
document.getElementById('livePrice').innerText="API Error";
}
}

function updateZ(price){
priceHistory.push(price);
if(priceHistory.length>WINDOW) priceHistory.shift();

if(priceHistory.length>=WINDOW){
const mean=priceHistory.reduce((a,b)=>a+b)/WINDOW;
const variance=priceHistory.map(p=>Math.pow(p-mean,2)).reduce((a,b)=>a+b)/WINDOW;
const std=Math.sqrt(variance);
const z=std>0?(price-mean)/std:0;

document.getElementById('zVal').innerText=z.toFixed(2);
document.getElementById('meanVal').innerText=mean.toFixed(4);

let signal=document.getElementById('signalBox');

if(z<-2){
signal.innerText="BUY ZONE";
signal.className="signal buy";
addLog("Oversold @ $"+price,"buy");
playAlert("buy");
}
else if(z>2){
signal.innerText="SELL ZONE";
signal.className="signal sell";
addLog("Overbought @ $"+price,"sell");
playAlert("sell");
}
else{
signal.innerText="NEUTRAL";
signal.className="signal wait";
}
}
}

function updateCalculations(){
const usd=parseFloat(document.getElementById('myUsd').value)||0;
const rate=parseFloat(document.getElementById('myRate').value)||0;

if(currentPrice>0 && usd>0 && rate>0){
const owned=usd*rate;
const value=owned*currentPrice;
const profit=value-usd;
const percent=(profit/usd)*100;

document.getElementById('totalCelo').innerText=owned.toFixed(2);
document.getElementById('totalVal').innerText="$"+value.toFixed(2);

let p=document.getElementById('profitAmount');
let per=document.getElementById('profitPercent');

p.innerText=(profit>=0?"+$":"-$")+Math.abs(profit).toFixed(2);
per.innerText=percent.toFixed(2)+"%";

if(profit>=0){ p.className="profit"; per.style.color="#2ecc71"; }
else{ p.className="loss"; per.style.color="#e74c3c"; }
}
}

function addLog(msg,type){
const time=new Date().toLocaleTimeString();
logs.unshift({time,msg,type});
if(logs.length>40) logs.pop();
localStorage.setItem('celo_logs',JSON.stringify(logs));
renderLogs();
}

function renderLogs(){
document.getElementById('logWindow').innerHTML=
logs.map(l=>`<div style="color:${l.type==='buy'?'#2ecc71':'#e74c3c'}">[${l.time}] ${l.msg}</div>`).join('');
}

function downloadCSV(){
let csv="Time,Message,Type\n"+logs.map(l=>`${l.time},${l.msg},${l.type}`).join("\n");
const blob=new Blob([csv],{type:'text/csv'});
const url=URL.createObjectURL(blob);
const a=document.createElement('a');
a.href=url;a.download="celo_logs.csv";a.click();
}

function clearLogs(){
localStorage.removeItem('celo_logs');
logs=[];
renderLogs();
}

function toggleBot(){
let t=document.getElementById('terminal');
t.style.display=t.style.display==='none'?'block':'none';
}

setInterval(fetchPrice,30000);
fetchPrice();
renderLogs();
</script>

</body>
</html>
